<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Head contents remain unchanged -->
    <!-- Insert your original <head> section here -->
    <!-- Your style and metadata will remain unchanged -->
    <!-- Ensure fonts, animations, etc., are still present -->
</head>
<body>

    <!-- Decorations and Hearts -->
    <div class="heart-container" id="heart-container"></div>
    <div class="decoration deco-top-left"></div>
    <div class="decoration deco-bottom-right"></div>

    <!-- Main Container -->
    <div class="container">
        <h1>Happy Raksha Bandhan!</h1>
        <div class="image-container" id="image-container">
            <img src="raksha-bandhan.jpg" alt="Happy Raksha Bandhan" class="rakhi-gif">
        </div>
        <p id="greeting-message">
            Sending a thread of love to celebrate our special bond. May our connection grow stronger and our hearts fonder. Wishing you a joyful and blessed Raksha Bandhan!
        </p>
        <button class="btn" onclick="openPopup()">✨ Create a Personalized Wish ✨</button>
    </div>

    <!-- Popup Modal -->
    <div id="popup">
        <div id="popup-content">
            <h2 style="font-family: 'Tangerine', cursive; color: #d81b60; font-size: 3.5em; margin-top:0;">Share a Special Wish!</h2>
            <p style="color: #555; margin-bottom: 20px;">Enter your name to create a magical Rakhi greeting for your sibling.</p>
            <input type="text" id="senderName" class="name-input" placeholder="Enter Your Name Here">
            <div id="popup-controls">
                <button class="btn back-btn" onclick="closePopup()">Back</button>
                <button class="btn" onclick="generateLink()">Generate Link</button>
            </div>
            <div id="share-section" style="display: none; margin-top: 25px;">
                <p>Your personalized link is ready! Share the magic:</p>
                <input type="text" id="copy-link-input" class="name-input" style="margin-bottom:10px;" readonly>
                <div>
                    <button class="btn" onclick="copyToClipboard()">Copy Link</button>
                    <a id="whatsapp-share-link" href="#" class="btn" target="_blank" style="background: linear-gradient(45deg, #25D366, #128C7E); box-shadow: 0 8px 25px rgba(37, 211, 102, 0.3);">Share on WhatsApp</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        function createHearts() {
            const heartContainer = document.getElementById('heart-container');
            const heartColors = ['heart-color-1', 'heart-color-2', 'heart-color-3', 'heart-color-4'];
            setInterval(() => {
                const heart = document.createElement('div');
                const randomColor = heartColors[Math.floor(Math.random() * heartColors.length)];
                heart.classList.add('heart', randomColor);
                heart.style.left = `${Math.random() * 100}vw`;
                heart.style.animationDuration = `${Math.random() * 3 + 5}s`;
                heart.style.opacity = Math.random() * 0.7 + 0.3;
                heart.style.transform = `scale(${Math.random() * 0.8 + 0.5}) rotate(-45deg)`;
                heartContainer.appendChild(heart);
                setTimeout(() => heart.remove(), 8000);
            }, 300);
        }

        function createGlitters() {
            const imageContainer = document.getElementById('image-container');
            setInterval(() => {
                const glitter = document.createElement('div');
                const type = Math.ceil(Math.random() * 3);
                glitter.classList.add('glitter', `glitter-type-${type}`);
                glitter.style.top = `${Math.random() * 100}%`;
                glitter.style.left = `${Math.random() * 100}%`;
                glitter.style.animationDelay = `${Math.random() * 2}s`;
                imageContainer.appendChild(glitter);
                setTimeout(() => glitter.remove(), 2000);
            }, 150);
        }

        function animateRecipientName(name) {
            const container = document.createElement('span');
            container.id = 'recipient-name-container';
            name.split('').forEach((char, index) => {
                const span = document.createElement('span');
                span.className = 'recipient-char';
                span.innerHTML = char === ' ' ? '&nbsp;' : char;
                span.style.animationDelay = `${index * 0.08 + 0.5}s`;
                container.appendChild(span);
            });
            return container;
        }

        window.onload = function() {
            createHearts();
            createGlitters();

            const urlParams = new URLSearchParams(window.location.search);
            const name = urlParams.get('name');
            if (name) {
                const greetingMessage = document.getElementById('greeting-message');
                const animatedName = animateRecipientName(decodeURIComponent(name));
                greetingMessage.innerHTML = '';
                greetingMessage.appendChild(animatedName);
                greetingMessage.append(" is sending a thread of love to celebrate our special bond. May our connection grow stronger and our hearts fonder. Wishing you a joyful and blessed Raksha Bandhan!");

                const repeatBtn = document.createElement('button');
                repeatBtn.innerText = "✨ Send Your Own Wish ✨";
                repeatBtn.className = "btn";
                repeatBtn.onclick = openPopup;
                document.querySelector('.container').appendChild(repeatBtn);
            }
        };

        function openPopup() {
            document.getElementById('popup').style.display = 'flex';
        }

        function closePopup() {
            document.getElementById('popup').style.display = 'none';
        }

        function generateLink() {
            const senderName = document.getElementById('senderName').value;
            if (senderName.trim() === "") {
                alert("Please enter your name!");
                return;
            }

            const baseUrl = window.location.origin + window.location.pathname; // same page link
            const personalizedLink = `${baseUrl}?name=${encodeURIComponent(senderName)}`;

            document.getElementById('copy-link-input').value = personalizedLink;

            const message = `\uD83D\uDC96 You've received a magical Raksha Bandhan wish from ${senderName}! \uD83D\uDC96\n\nCheck it out: ${personalizedLink}`;
            const whatsappUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(message)}`;
            document.getElementById('whatsapp-share-link').href = whatsappUrl;

            document.getElementById('share-section').style.display = 'block';
        }

        function copyToClipboard() {
            const copyText = document.getElementById('copy-link-input');
            copyText.select();
            copyText.setSelectionRange(0, 99999);
            document.execCommand("copy");
            alert("Link copied to clipboard!");
        }
    </script>

</body>
</html>
